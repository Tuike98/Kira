{"ast":null,"code":"import React,{useState,useEffect}from'react';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function License(_ref){let{isAuthenticated}=_ref;if(!isAuthenticated){return/*#__PURE__*/_jsx(\"div\",{className:\"page\",children:/*#__PURE__*/_jsx(\"p\",{children:\"Prosz\\u0119 si\\u0119 zalogowa\\u0107, aby uzyska\\u0107 dost\\u0119p do tej strony.\"})});}const[servers,setServers]=useState([]);const[licenseKey,setLicenseKey]=useState('');const[selectedServer,setSelectedServer]=useState('');useEffect(()=>{fetchServers();fetchLicenses();},[]);const fetchServers=async()=>{try{const response=await fetch('/api/servers');const data=await response.json();setServers(data);}catch(error){console.error('Error fetching servers:',error);}};const fetchLicenses=async()=>{try{const response=await fetch('/api/licenses');const licenses=await response.json();setServers(prevServers=>prevServers.map(server=>{const license=licenses.find(lic=>lic.serverId===server.id);if(license){const daysLeft=Math.ceil((new Date(license.expiresAt)-new Date())/(1000*60*60*24));return{...server,licenseExpires:license.expiresAt,daysLeft:daysLeft};}return server;}));}catch(error){console.error('Error fetching licenses:',error);}};const handleActivateLicense=async event=>{event.preventDefault();if(licenseKey&&selectedServer){try{const response=await fetch('/api/licenses',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({key:licenseKey,serverId:selectedServer})});if(response.ok){const newLicense=await response.json();setServers(prevServers=>prevServers.map(server=>server.id===newLicense.serverId?{...server,licenseExpires:newLicense.expiresAt,daysLeft:Math.ceil((new Date(newLicense.expiresAt)-new Date())/(1000*60*60*24))}:server));}else{alert('Failed to activate license.');}}catch(error){console.error('Error activating license:',error);alert('An error occurred while activating the license.');}}else{alert('Please enter a license key and select a server.');}};return/*#__PURE__*/_jsxs(\"div\",{className:\"page\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"License\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleActivateLicense,children:[/*#__PURE__*/_jsxs(\"label\",{children:[\"License Key:\",/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:licenseKey,onChange:e=>setLicenseKey(e.target.value)})]}),/*#__PURE__*/_jsxs(\"label\",{children:[\"Select Server:\",/*#__PURE__*/_jsxs(\"select\",{value:selectedServer,onChange:e=>setSelectedServer(e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select a server\"}),servers.map(server=>/*#__PURE__*/_jsx(\"option\",{value:server.id,children:server.name},server.id))]})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Activate\"})]}),/*#__PURE__*/_jsx(\"h2\",{children:\"Servers\"}),/*#__PURE__*/_jsx(\"ul\",{children:servers.map(server=>/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"img\",{src:\"https://cdn.discordapp.com/icons/\".concat(server.id,\"/\").concat(server.icon,\".png\"),alt:\"\".concat(server.name,\" icon\"),width:\"50\",height:\"50\"}),server.name,server.licenseExpires?/*#__PURE__*/_jsxs(\"span\",{children:[\" - License expires on \",server.licenseExpires,\" (\",server.daysLeft,\" days left)\"]}):/*#__PURE__*/_jsx(\"span\",{children:\" - No license\"})]},server.id))})]});}export default License;","map":{"version":3,"names":["React","useState","useEffect","jsx","_jsx","jsxs","_jsxs","License","_ref","isAuthenticated","className","children","servers","setServers","licenseKey","setLicenseKey","selectedServer","setSelectedServer","fetchServers","fetchLicenses","response","fetch","data","json","error","console","licenses","prevServers","map","server","license","find","lic","serverId","id","daysLeft","Math","ceil","Date","expiresAt","licenseExpires","handleActivateLicense","event","preventDefault","method","headers","body","JSON","stringify","key","ok","newLicense","alert","onSubmit","type","value","onChange","e","target","name","src","concat","icon","alt","width","height"],"sources":["/home/kira/panel/src/pages/License.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\n\nfunction License({ isAuthenticated }) {\n  if (!isAuthenticated) {\n    return <div className=\"page\"><p>Proszę się zalogować, aby uzyskać dostęp do tej strony.</p></div>;\n  }\n\n  const [servers, setServers] = useState([]);\n  const [licenseKey, setLicenseKey] = useState('');\n  const [selectedServer, setSelectedServer] = useState('');\n\n  useEffect(() => {\n    fetchServers();\n    fetchLicenses();\n  }, []);\n\n  const fetchServers = async () => {\n    try {\n      const response = await fetch('/api/servers');\n      const data = await response.json();\n      setServers(data);\n    } catch (error) {\n      console.error('Error fetching servers:', error);\n    }\n  };\n\n  const fetchLicenses = async () => {\n    try {\n      const response = await fetch('/api/licenses');\n      const licenses = await response.json();\n      setServers(prevServers =>\n        prevServers.map(server => {\n          const license = licenses.find(lic => lic.serverId === server.id);\n          if (license) {\n            const daysLeft = Math.ceil(\n              (new Date(license.expiresAt) - new Date()) / (1000 * 60 * 60 * 24)\n            );\n            return {\n              ...server,\n              licenseExpires: license.expiresAt,\n              daysLeft: daysLeft,\n            };\n          }\n          return server;\n        })\n      );\n    } catch (error) {\n      console.error('Error fetching licenses:', error);\n    }\n  };\n\n  const handleActivateLicense = async (event) => {\n    event.preventDefault();\n    if (licenseKey && selectedServer) {\n      try {\n        const response = await fetch('/api/licenses', {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n          },\n          body: JSON.stringify({\n            key: licenseKey,\n            serverId: selectedServer,\n          }),\n        });\n        if (response.ok) {\n          const newLicense = await response.json();\n          setServers(prevServers =>\n            prevServers.map(server =>\n              server.id === newLicense.serverId\n                ? {\n                    ...server,\n                    licenseExpires: newLicense.expiresAt,\n                    daysLeft: Math.ceil(\n                      (new Date(newLicense.expiresAt) - new Date()) /\n                      (1000 * 60 * 60 * 24)\n                    ),\n                  }\n                : server\n            )\n          );\n        } else {\n          alert('Failed to activate license.');\n        }\n      } catch (error) {\n        console.error('Error activating license:', error);\n        alert('An error occurred while activating the license.');\n      }\n    } else {\n      alert('Please enter a license key and select a server.');\n    }\n  };\n\n  return (\n    <div className=\"page\">\n      <h1>License</h1>\n      <form onSubmit={handleActivateLicense}>\n        <label>\n          License Key:\n          <input\n            type=\"text\"\n            value={licenseKey}\n            onChange={(e) => setLicenseKey(e.target.value)}\n          />\n        </label>\n        <label>\n          Select Server:\n          <select\n            value={selectedServer}\n            onChange={(e) => setSelectedServer(e.target.value)}\n          >\n            <option value=\"\">Select a server</option>\n            {servers.map((server) => (\n              <option key={server.id} value={server.id}>\n                {server.name}\n              </option>\n            ))}\n          </select>\n        </label>\n        <button type=\"submit\">Activate</button>\n      </form>\n      <h2>Servers</h2>\n      <ul>\n        {servers.map((server) => (\n          <li key={server.id}>\n            <img src={`https://cdn.discordapp.com/icons/${server.id}/${server.icon}.png`} alt={`${server.name} icon`} width=\"50\" height=\"50\" />\n            {server.name}\n            {server.licenseExpires ? (\n              <span> - License expires on {server.licenseExpires} ({server.daysLeft} days left)</span>\n            ) : (\n              <span> - No license</span>\n            )}\n          </li>\n        ))}\n      </ul>\n    </div>\n  );\n}\n\nexport default License;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}