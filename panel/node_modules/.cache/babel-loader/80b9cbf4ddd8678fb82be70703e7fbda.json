{"ast":null,"code":"import React,{useState,useEffect}from'react';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function License(_ref){let{isAuthenticated}=_ref;const[servers,setServers]=useState([]);const[licenseKey,setLicenseKey]=useState('');const[selectedServer,setSelectedServer]=useState('');const[loading,setLoading]=useState(true);const[error,setError]=useState(null);useEffect(()=>{if(isAuthenticated){fetchServers();fetchLicenses();}else{setLoading(false);}},[isAuthenticated]);const fetchServers=async()=>{try{const response=await fetch('/api/servers');if(!response.ok)throw new Error('Failed to fetch servers');const data=await response.json();setServers(data);}catch(error){console.error('Error fetching servers:',error);setError('Error fetching servers');}finally{setLoading(false);}};const fetchLicenses=async()=>{try{const response=await fetch('/api/licenses');if(!response.ok)throw new Error('Failed to fetch licenses');const licenses=await response.json();setServers(prevServers=>prevServers.map(server=>{const license=licenses.find(lic=>lic.serverId===server.id);if(license){const daysLeft=Math.ceil((new Date(license.expiresAt)-new Date())/(1000*60*60*24));return{...server,licenseExpires:license.expiresAt,daysLeft:daysLeft};}return server;}));}catch(error){console.error('Error fetching licenses:',error);setError('Error fetching licenses');}};const handleActivateLicense=async event=>{event.preventDefault();if(licenseKey&&selectedServer){try{const response=await fetch('/api/licenses',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({key:licenseKey,serverId:selectedServer})});if(!response.ok)throw new Error('Failed to activate license');const newLicense=await response.json();setServers(prevServers=>prevServers.map(server=>server.id===newLicense.serverId?{...server,licenseExpires:newLicense.expiresAt,daysLeft:Math.ceil((new Date(newLicense.expiresAt)-new Date())/(1000*60*60*24))}:server));}catch(error){console.error('Error activating license:',error);setError('Error activating license');}}else{alert('Please enter a license key and select a server.');}};if(!isAuthenticated){return/*#__PURE__*/_jsx(\"div\",{className:\"page\",children:/*#__PURE__*/_jsx(\"p\",{children:\"Prosz\\u0119 si\\u0119 zalogowa\\u0107, aby uzyska\\u0107 dost\\u0119p do tej strony.\"})});}if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"page\",children:/*#__PURE__*/_jsx(\"p\",{children:\"Loading...\"})});}if(error){return/*#__PURE__*/_jsx(\"div\",{className:\"page\",children:/*#__PURE__*/_jsx(\"p\",{children:error})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"page\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"License\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleActivateLicense,children:[/*#__PURE__*/_jsxs(\"label\",{children:[\"License Key:\",/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:licenseKey,onChange:e=>setLicenseKey(e.target.value)})]}),/*#__PURE__*/_jsxs(\"label\",{children:[\"Select Server:\",/*#__PURE__*/_jsxs(\"select\",{value:selectedServer,onChange:e=>setSelectedServer(e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select a server\"}),servers.map(server=>/*#__PURE__*/_jsx(\"option\",{value:server.id,children:server.name},server.id))]})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Activate\"})]}),/*#__PURE__*/_jsx(\"h2\",{children:\"Servers\"}),/*#__PURE__*/_jsx(\"ul\",{children:servers.map(server=>/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"img\",{src:\"https://cdn.discordapp.com/icons/\".concat(server.id,\"/\").concat(server.icon,\".png\"),alt:\"\".concat(server.name,\" icon\"),width:\"50\",height:\"50\"}),server.name,server.licenseExpires?/*#__PURE__*/_jsxs(\"span\",{children:[\" - License expires on \",server.licenseExpires,\" (\",server.daysLeft,\" days left)\"]}):/*#__PURE__*/_jsx(\"span\",{children:\" - No license\"})]},server.id))})]});}export default License;","map":{"version":3,"names":["React","useState","useEffect","jsx","_jsx","jsxs","_jsxs","License","_ref","isAuthenticated","servers","setServers","licenseKey","setLicenseKey","selectedServer","setSelectedServer","loading","setLoading","error","setError","fetchServers","fetchLicenses","response","fetch","ok","Error","data","json","console","licenses","prevServers","map","server","license","find","lic","serverId","id","daysLeft","Math","ceil","Date","expiresAt","licenseExpires","handleActivateLicense","event","preventDefault","method","headers","body","JSON","stringify","key","newLicense","alert","className","children","onSubmit","type","value","onChange","e","target","name","src","concat","icon","alt","width","height"],"sources":["/home/kira/panel/src/pages/License.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\n\nfunction License({ isAuthenticated }) {\n  const [servers, setServers] = useState([]);\n  const [licenseKey, setLicenseKey] = useState('');\n  const [selectedServer, setSelectedServer] = useState('');\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  useEffect(() => {\n    if (isAuthenticated) {\n      fetchServers();\n      fetchLicenses();\n    } else {\n      setLoading(false);\n    }\n  }, [isAuthenticated]);\n\n  const fetchServers = async () => {\n    try {\n      const response = await fetch('/api/servers');\n      if (!response.ok) throw new Error('Failed to fetch servers');\n      const data = await response.json();\n      setServers(data);\n    } catch (error) {\n      console.error('Error fetching servers:', error);\n      setError('Error fetching servers');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const fetchLicenses = async () => {\n    try {\n      const response = await fetch('/api/licenses');\n      if (!response.ok) throw new Error('Failed to fetch licenses');\n      const licenses = await response.json();\n      setServers(prevServers =>\n        prevServers.map(server => {\n          const license = licenses.find(lic => lic.serverId === server.id);\n          if (license) {\n            const daysLeft = Math.ceil(\n              (new Date(license.expiresAt) - new Date()) / (1000 * 60 * 60 * 24)\n            );\n            return {\n              ...server,\n              licenseExpires: license.expiresAt,\n              daysLeft: daysLeft,\n            };\n          }\n          return server;\n        })\n      );\n    } catch (error) {\n      console.error('Error fetching licenses:', error);\n      setError('Error fetching licenses');\n    }\n  };\n\n  const handleActivateLicense = async (event) => {\n    event.preventDefault();\n    if (licenseKey && selectedServer) {\n      try {\n        const response = await fetch('/api/licenses', {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n          },\n          body: JSON.stringify({\n            key: licenseKey,\n            serverId: selectedServer,\n          }),\n        });\n        if (!response.ok) throw new Error('Failed to activate license');\n        const newLicense = await response.json();\n        setServers(prevServers =>\n          prevServers.map(server =>\n            server.id === newLicense.serverId\n              ? {\n                  ...server,\n                  licenseExpires: newLicense.expiresAt,\n                  daysLeft: Math.ceil(\n                    (new Date(newLicense.expiresAt) - new Date()) /\n                    (1000 * 60 * 60 * 24)\n                  ),\n                }\n              : server\n          )\n        );\n      } catch (error) {\n        console.error('Error activating license:', error);\n        setError('Error activating license');\n      }\n    } else {\n      alert('Please enter a license key and select a server.');\n    }\n  };\n\n  if (!isAuthenticated) {\n    return <div className=\"page\"><p>Proszę się zalogować, aby uzyskać dostęp do tej strony.</p></div>;\n  }\n\n  if (loading) {\n    return <div className=\"page\"><p>Loading...</p></div>;\n  }\n\n  if (error) {\n    return <div className=\"page\"><p>{error}</p></div>;\n  }\n\n  return (\n    <div className=\"page\">\n      <h1>License</h1>\n      <form onSubmit={handleActivateLicense}>\n        <label>\n          License Key:\n          <input\n            type=\"text\"\n            value={licenseKey}\n            onChange={(e) => setLicenseKey(e.target.value)}\n          />\n        </label>\n        <label>\n          Select Server:\n          <select\n            value={selectedServer}\n            onChange={(e) => setSelectedServer(e.target.value)}\n          >\n            <option value=\"\">Select a server</option>\n            {servers.map((server) => (\n              <option key={server.id} value={server.id}>\n                {server.name}\n              </option>\n            ))}\n          </select>\n        </label>\n        <button type=\"submit\">Activate</button>\n      </form>\n      <h2>Servers</h2>\n      <ul>\n        {servers.map((server) => (\n          <li key={server.id}>\n            <img src={`https://cdn.discordapp.com/icons/${server.id}/${server.icon}.png`} alt={`${server.name} icon`} width=\"50\" height=\"50\" />\n            {server.name}\n            {server.licenseExpires ? (\n              <span> - License expires on {server.licenseExpires} ({server.daysLeft} days left)</span>\n            ) : (\n              <span> - No license</span>\n            )}\n          </li>\n        ))}\n      </ul>\n    </div>\n  );\n}\n\nexport default License;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}